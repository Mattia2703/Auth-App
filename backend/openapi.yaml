openapi: 3.0.3
info:
  title: JWT Auth Node.js API
  description: API documentation for your Node.js JWT Authentication app
  version: 1.0.0
servers:
  - url: http://localhost:8080
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
paths:
  /api/auth/signup:
    post:
      summary: Register a new user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - username
                - email
                - password
              properties:
                username:
                  type: string
                  example: user1
                email:
                  type: string
                  example: user1@example.com
                password:
                  type: string
                  example: password123
      responses:
        "200":
          description: User created successfully
  /api/auth/signin:
    post:
      summary: Login a user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - username
                - password
              properties:
                username:
                  type: string
                  example: user1
                password:
                  type: string
                  example: password123
      responses:
        "200":
          description: Login successful
  /api/data:
    get:
      summary: Fetch protected data
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Returns data
  /api/data/weather:
    get:
      summary: Get current weather for a location
      description: Retrieves current weather data using the Open-Meteo API. Requires `latitude` and `longitude` query parameters.
      security:
        - bearerAuth: []
      parameters:
        - name: latitude
          in: query
          required: true
          schema:
            type: number
            example: 52.52
        - name: longitude
          in: query
          required: true
          schema:
            type: number
            example: 13.41
      responses:
        "200":
          description: Returns current weather data
          content:
            application/json:
              schema:
                type: object
                required:
                  - success
                  - location
                  - current
                properties:
                  success:
                    type: boolean
                    example: true
                  location:
                    type: object
                    required:
                      - latitude
                      - longitude
                      - timezone
                    properties:
                      latitude:
                        type: number
                        example: 52.52
                      longitude:
                        type: number
                        example: 13.41
                      timezone:
                        type: string
                        example: Europe/Berlin
                  current:
                    type: object
                    required:
                      - time
                      - temperature
                      - apparentTemperature
                      - humidity
                      - precipitation
                      - weatherCode
                      - wind
                    properties:
                      time:
                        type: string
                        format: date-time
                        example: "2025-12-02T12:00:00Z"
                      temperature:
                        type: object
                        required: [value, unit]
                        properties:
                          value:
                            type: number
                            example: 5.4
                          unit:
                            type: string
                            example: "°C"
                      apparentTemperature:
                        type: object
                        required: [value, unit]
                        properties:
                          value:
                            type: number
                            example: 3.2
                          unit:
                            type: string
                            example: "°C"
                      humidity:
                        type: object
                        required: [value, unit]
                        properties:
                          value:
                            type: number
                            example: 85
                          unit:
                            type: string
                            example: "%"
                      precipitation:
                        type: object
                        required: [value, unit]
                        properties:
                          value:
                            type: number
                            example: 0.0
                          unit:
                            type: string
                            example: "mm"
                      weatherCode:
                        type: integer
                        example: 1
                      wind:
                        type: object
                        required: [speed, direction]
                        properties:
                          speed:
                            type: object
                            required: [value, unit]
                            properties:
                              value:
                                type: number
                                example: 3.5
                              unit:
                                type: string
                                example: "km/h"
                          direction:
                            type: object
                            required: [value, unit]
                            properties:
                              value:
                                type: number
                                example: 180
                              unit:
                                type: string
                                example: "°"
        "400":
          description: Invalid or missing latitude/longitude
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Latitude and longitude are required
        "500":
          description: Failed to fetch weather data
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: Failed to fetch weather data
                  error:
                    type: string
                    example: Network error
  /api/data/exchange:
    get:
      summary: Get EUR to USD exchange rates for a date range
      description: >
        Returns historical EUR to USD exchange rates between `startDate` and `endDate`.
        Useful for charting purposes.
      security:
        - bearerAuth: []
      parameters:
        - name: startDate
          in: query
          required: true
          schema:
            type: string
            format: date
            example: "2025-11-25"
          description: Start date of the range (YYYY-MM-DD)
        - name: endDate
          in: query
          required: true
          schema:
            type: string
            format: date
            example: "2025-12-01"
          description: End date of the range (YYYY-MM-DD)
      responses:
        "200":
          description: Historical exchange rates
          content:
            application/json:
              schema:
                type: object
                required:
                  - success
                  - base
                  - startDate
                  - endDate
                  - rates
                properties:
                  success:
                    type: boolean
                    example: true
                  base:
                    type: string
                    example: EUR
                  startDate:
                    type: string
                    format: date
                    example: "2025-11-25"
                  endDate:
                    type: string
                    format: date
                    example: "2025-12-01"
                  rates:
                    type: array
                    items:
                      type: object
                      required: [date, rate]
                      properties:
                        date:
                          type: string
                          format: date
                          example: "2025-11-25"
                        rate:
                          type: number
                          example: 1.082
        "400":
          description: Missing or invalid query parameters
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: "startDate and endDate query parameters are required"
        "500":
          description: Failed to fetch exchange rates
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: Failed to fetch exchange rates
                  error:
                    type: string
                    example: Network error
  /api/data/flight:
    get:
      summary: Get current flight data by flight number
      description: Fetches live flight data using OpenSky Network API (no API key needed)
      security:
        - bearerAuth: []
      parameters:
        - name: flightNumber
          in: query
          required: true
          schema:
            type: string
            example: "LH1234"
      responses:
        "200":
          description: Flight data returned
          content:
            application/json:
              schema:
                type: object
                required:
                  - success
                  - flights
                properties:
                  success:
                    type: boolean
                    example: true
                  flights:
                    type: array
                    items:
                      type: object
                      required:
                        - icao24
                        - callsign
                        - origin_country
                        - time_position
                        - last_contact
                        - longitude
                        - latitude
                        - baro_altitude
                        - on_ground
                        - velocity
                        - true_track
                        - vertical_rate
                      properties:
                        icao24:
                          type: string
                          example: "3c6444"
                        callsign:
                          type: string
                          example: "LH1234"
                        origin_country:
                          type: string
                          example: "Germany"
                        time_position:
                          type: integer
                          example: 1672531200
                        last_contact:
                          type: integer
                          example: 1672531210
                        longitude:
                          type: number
                          example: 13.404
                        latitude:
                          type: number
                          example: 52.52
                        baro_altitude:
                          type: number
                          example: 11000
                        on_ground:
                          type: boolean
                          example: false
                        velocity:
                          type: number
                          example: 230
                        true_track:
                          type: number
                          example: 90
                        vertical_rate:
                          type: number
                          example: 5
        "400":
          description: Missing flightNumber
        "404":
          description: Flight not found
        "500":
          description: Failed to fetch flight data
  /api/data/random-flight:
    get:
      summary: Get a random current flight
      description: Fetches a single random flight from the OpenSky Network API (no API key needed)
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Random flight data returned
          content:
            application/json:
              schema:
                type: object
                required:
                  - success
                  - flight
                properties:
                  success:
                    type: boolean
                    example: true
                  flight:
                    type: object
                    required:
                      - icao24
                      - callsign
                      - origin_country
                      - time_position
                      - last_contact
                      - longitude
                      - latitude
                      - baro_altitude
                      - on_ground
                      - velocity
                      - true_track
                      - vertical_rate
                    properties:
                      icao24:
                        type: string
                        example: "3c6444"
                      callsign:
                        type: string
                        example: "LH1234"
                      origin_country:
                        type: string
                        example: "Germany"
                      time_position:
                        type: integer
                        example: 1672531200
                      last_contact:
                        type: integer
                        example: 1672531210
                      longitude:
                        type: number
                        example: 13.404
                      latitude:
                        type: number
                        example: 52.52
                      baro_altitude:
                        type: number
                        example: 11000
                      on_ground:
                        type: boolean
                        example: false
                      velocity:
                        type: number
                        example: 230
                      true_track:
                        type: number
                        example: 90
                      vertical_rate:
                        type: number
                        example: 5
        "404":
          description: No flights available
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: "No flights currently available"
        "500":
          description: Failed to fetch flight data
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: "Failed to fetch flight data"
                  error:
                    type: string
                    example: "Network error"
  /api/auth/refresh:
    post:
      summary: Refresh access token
      description: Generates a new access token and rotates the refresh token.
        Requires a valid (non-expired) refresh token in the request body.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - refreshToken
              properties:
                refreshToken:
                  type: string
                  example: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
      responses:
        "200":
          description: New access and refresh tokens generated
          content:
            application/json:
              schema:
                type: object
                required:
                  - accessToken
                  - refreshToken
                properties:
                  accessToken:
                    type: string
                    example: newAccessTokenHere
                  refreshToken:
                    type: string
                    example: newRefreshTokenHere
        "403":
          description: Invalid or expired refresh token
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Refresh token expired. Please log in again.
        "500":
          description: Server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Internal server error
